
<html>   
<head><title>Incognito</title>
<meta charset="utf-8">
<link href="css/style.css" rel='stylesheet' type='text/css' />
<link href="css/bubble.css" rel='stylesheet' type='text/css' />
<link href="css/container.css" rel='stylesheet' type='text/css' />
<link href="js/jquery-ui-1.11.4/jquery-ui.min.css" rel='stylesheet' type='text/css' />

<link href='http://fonts.googleapis.com/css?family=Open+Sans:600italic,400,300,600,700' rel='stylesheet' type='text/css'>

<script src="/socket.io/socket.io.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/jspdf/0.9.0rc1/jspdf.js"></script>
<script src="js/jquery-2.1.3.min.js" type="text/javascript"></script>
<script src="js/jquery-ui-1.11.4/jquery-ui.min.js" type="text/javascript"></script>

<script src="js/moment.js"></script>
<script src="js/livestamp.min.js"></script>

<script src="js/core_utils.js"></script>
<script src="js/client.js"></script>
<script src="js/initializer.js"></script>

<script>

    var maxval = Number.MIN_VALUE, minval = Number.MAX_VALUE;
    var unlock = true;
    var userName,usertype,userID,imageNo,startTime,endTime,timediff,endEpoch,currentEpoch;
    var IMAGES_COUNT = 300;
    var Incognito = {},Helper = {};
        
        function format(n){
            return n > 9 ? "" + n: "0" + n;
        };
        
        function displayTime (timeDiff,element,text) {
            timeDiff /= 1000;

            var seconds = Math.round(timeDiff % 60);
            timeDiff = Math.floor(timeDiff / 60);

            var minutes = Math.round(timeDiff % 60);
            timeDiff = Math.floor(timeDiff / 60);

            var hours = Math.round(timeDiff % 24);
            timeDiff = Math.floor(timeDiff / 24);

            var days = timeDiff;
            text = '<span class="light-shades">'+text +'</span>'
            $(element).html(text + this.format(hours) + ":" + this.format(minutes) + ":" + this.format(seconds));
        }; 
        function elapsedisplay() {
            var current = new Date();
            var timeDiff = current - startTime;
            
            displayTime(timeDiff,".elapsetime",'Elapsed Time: ');
            setTimeout(elapsedisplay, 1000);
        };
        function remainingdisplay() {
            var current = new Date();
            var timeDiff = endTime - current;
            
            displayTime(timeDiff,".remainingtime",'Remaining Time: ');
            setTimeout(remainingdisplay, 1000);
        };

    jQuery(document).ready(function () {
        userName  = "<%= userName %>";
        userID    = "<%= userID %>";
        startTime = new Date("<%= startTime %>");
        endTime   = new Date("<%= endTime %>");
        imageNo   = userID % IMAGES_COUNT;
        imageSrc  = "/images/profile_pictures/random/"+imageNo+".png"
        socket.emit('send_new_user',{userID: userID, userName: userName});
        
        endEpoch     = endTime.getTime();
        currentEpoch = Date.now();
        timediff     = Math.floor(endEpoch - currentEpoch);

        Incognito = Initializer;
        Incognito.init();
        Helper = CoreUtil;
            
        setTimeout(elapsedisplay, 1000);
        setTimeout(remainingdisplay,1000);
        setInterval(function(){ 
                socket.emit('send_top_questions',minval);
            }, 300000);

        setTimeout(function() {
            $("#sendBox").hide();
        },timediff);
        
        setTimeout(function() {
            $.get('/generatingPDF',{},function(data){
                if(userName != "anonymous_user"){
                    $("#footer").append("<div id='sessionEnd'>This Session has ended!</br/><input type='button' onclick=window.location.href='/download' value='Export Transcript'/></div>");
                }else{
                    $("#footer").append("<div id='sessionEnd'>This Session has ended!</br/></div>");
                }

                $("#conversation").unbind();
            })
        },timediff);
    });

</script>
</head>

<body id="chat">
<div id="dialog-message" title="Things to know before you join in">
    <span class="ui-state-default">
        <span class="ui-icon ui-icon-info" style="float:left; margin:0 7px 0 0;"></span>
    </span>
    <div style="margin-left: 23px;">
        <p>
            <ul>
                <li><span class="bold">We don't know who you are. We don't track you.</span><br /></li>
                <br/>
                <li><span class="bold">So be nice, be polite and contribute constructively!</span></br></li>
                <br/>
                <li>This icon will represent <span class="bold">you</span> in this conversation</li>
                <br/>
            </ul><center>
                <img class="smallSizeImg" id="profileID_2" src=""/></center>
            </p>
        </p>
    </div>
</div>
     
     <div id="details">
            <div id="heading">
                <div class="main-wrap">
                    <div class="right-text"><br/>
                        <span class="title">Women @ Freshdesk</span></br/>
                        <span class="light-shades">11 Sep 2015, 3:30PM - 5:30PM</span>
                    </div>
                    <div class="left-img">
                        <img class="small-logo" src="/images/incognito-logo.png"/>
                    </div>
                </div>
            </div>
                    <span class="light-shades">
                    <hr>
                </span>
                <div class="justify">
                    <span class="light-shades">
                Thanks for participating in our ‘Women @ Freshdesk’ event! <br/><br/>
                We want to hear your feedback on the event, and ideas on how we can make this more useful for you in the future. Your identity will be completely anonymous, so you can discuss specific issues or concerns you may have, provide suggestions to others, ask for advice or generally vent to your fellow women!<br/><br/>
                As a first time experiment, we will have this open until Monday evening. If this is something useful, we will have this up and running more often!<br/>
                    </span>
                </div>               
            <section class="ac-container">
                <div>
                    <input id="ac-1" name="accordion-1" type="radio" checked="">
                    <label for="ac-1">Basic Information</label>
                    <article class="ac-small">
                        <br/>
                        <div id="info">
                            <span class="light-shades">Moderator:</span> Monika Gunalan<br/>
                            <div id="count"></div>
                            <div class="elapsetime"></div>
                            <div class="remainingtime"></div>
                        </div>    
                    </article>
                </div>
<!--                 <div>
                    <input id="ac-3" name="accordion-1" type="radio">
                    <label for="ac-3">Agenda</label>
                    <article class="ac-medium">
                    <div id="info">
                        <ul>
                            <li>Leave Policy</li>
                            <li>Spl Women Policy </li>
                            <li>Company Policy </li>
                            <li>Question & Answers</li>
                         </ul>
                    </div>   
                    </article>
                </div> -->
                <div>
                    <input id="ac-2" name="accordion-1" type="radio">
                    <label for="ac-2">Top Posts</label>
                    <article class="ac-large">
                          <div id="top_questions">
                            <p>Do vote the questions!<p></div>
                    </article>
                </div>
              
               <!--  <div>
                    <input id="ac-4" name="accordion-1" type="radio">
                    <label for="ac-4">Feedback</label>
                    <article class="ac-large">
                    </article>
                </div> -->
            </section>
            <br/>
        </div>   
                
        <div id="msg">
            <div id="conversation">
            </div>
            <div id="footer">
                <div id="sendBox">
                    <div class="item">
                        <img class="smallSizeImg" id="profileID_1" src=""/>
                        <span class="userName bold">You<br/></span>

                    </div>
                     <textarea id="data" rows="5" cols="130" placeholder="Share your thoughts..."></textarea>
                     <input type="button" id="datasend" value="Send" />
                </div>     
            </div>
        </div>                               
</body>
</html>
